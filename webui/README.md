# 现代化WebUI控制台

## 概述

这是一个为LLM-Manager设计的现代化Web控制台界面，提供了完整的模型管理、监控和分析功能。

## 功能特性

### 🎯 总览仪表板
- **实时系统状态**: 显示总模型数、运行中模型数量、系统吞吐量等关键指标
- **GPU监控**: 实时显示GPU使用情况和内存状态
- **实时更新**: 所有数据每5秒自动刷新

### 🚀 模型管理
- **启动/停止控制**: 一键启停任何模型
- **实时状态显示**: 查看模型运行状态、端口信息、待处理请求数
- **批量操作**: 支持同时管理多个模型

### 📊 性能监控
- **实时吞吐量图表**: 显示系统整体和各个模型的吞吐量变化
- **时间范围选择**: 支持1小时、6小时、24小时的数据查看
- **交互式图表**: 基于Chart.js的现代化图表组件

### 📜 实时控制台
- **模型日志查看**: 选择任何模型查看其实时输出日志
- **日志级别过滤**: 自动识别并高亮显示不同级别的日志（错误、警告、成功）
- **实时更新**: 日志每秒自动刷新，确保看到最新输出
- **日志清空**: 一键清空控制台输出

### 💰 成本分析
- **Token消耗统计**: 按模型统计输入和输出Token使用量
- **价格配置**: 可自定义输入和输出Token的单价
- **成本计算**: 自动计算日成本和月成本预估
- **实时更新**: 价格变化立即反映在成本计算中

### 🔧 系统监控
- **WebSocket支持**: 实时数据推送，无需手动刷新
- **错误处理**: 完善的错误处理和用户友好的错误提示
- **响应式设计**: 适配各种屏幕尺寸

## 技术架构

### 前端技术栈
- **HTML5/CSS3**: 现代化的页面结构和样式
- **Tailwind CSS**: 快速构建美观的用户界面
- **Chart.js**: 专业的图表库，用于数据可视化
- **JavaScript ES6+**: 现代化的JavaScript功能
- **WebSocket**: 实时数据通信
- **Font Awesome**: 专业的图标库

### 后端技术栈
- **FastAPI**: 高性能的Python Web框架
- **Uvicorn**: ASGI服务器，提供出色的性能
- **WebSocket**: 实时双向通信
- **异步处理**: 高效的并发处理能力

## 安装和使用

### 1. 安装依赖
确保已安装所有必需的依赖：
```bash
pip install -r requirements.txt
```

### 2. 启动系统
运行主程序：
```bash
python main.py
```

### 3. 访问WebUI
系统会自动启动两个WebUI服务：

- **Gradio WebUI**: http://127.0.0.1:10000
  - 原有的功能界面
  - 基本的模型控制功能

- **现代化WebUI**: http://127.0.0.1:10001
  - 全新的现代化界面
  - 完整的监控和分析功能

## API文档

### 系统状态API
- `GET /api/system/status` - 获取系统整体状态
- `GET /api/models` - 获取模型列表和状态
- `GET /api/models/{model_id}/logs` - 获取特定模型的日志

### 模型控制API
- `POST /api/models/{model_id}/start` - 启动模型
- `POST /api/models/{model_id}/stop` - 停止模型

### 分析API
- `GET /api/analytics/throughput` - 获取吞吐量历史数据
- `GET /api/analytics/tokens` - 获取Token消耗统计
- `GET /api/analytics/cost` - 获取成本分析数据
- `POST /api/analytics/prices` - 更新价格设置

### WebSocket
- `ws://127.0.0.1:10001/ws` - 实时数据推送

## 配置说明

### 价格配置
在WebUI中，你可以通过以下方式配置Token价格：
1. 进入"成本分析"部分
2. 设置输入Token价格（默认：$0.001/1K tokens）
3. 设置输出Token价格（默认：$0.002/1K tokens）
4. 成本计算会自动更新

### 监控配置
- **刷新间隔**: 系统状态每5秒自动刷新
- **日志更新**: 控制台输出每秒自动刷新
- **图表更新**: 吞吐量图表每2秒更新一次

## 故障排除

### 常见问题

1. **无法访问WebUI**
   - 确保端口未被占用
   - 检查防火墙设置
   - 验证系统是否正常启动

2. **模型启动失败**
   - 检查模型配置文件
   - 确认GPU资源是否充足
   - 查看错误日志获取详细信息

3. **数据不更新**
   - 检查网络连接
   - 刷新页面
   - 查看浏览器控制台错误

4. **图表不显示**
   - 确保浏览器支持JavaScript
   - 检查Chart.js是否正确加载
   - 尝试清除浏览器缓存

## 开发说明

### 项目结构
```
webui/
├── index.html          # 主页面
├── server.py          # FastAPI服务器
└── README.md          # 文档
```

### 扩展功能
系统采用模块化设计，可以轻松添加新功能：
1. **新的监控指标**: 在`server.py`中添加新的API端点
2. **新的图表类型**: 在前端添加新的Chart.js配置
3. **新的控制功能**: 扩展现有的模型控制API

### 自定义主题
可以通过修改`index.html`中的CSS变量来自定义界面主题：
```css
:root {
    --primary-color: #3B82F6;
    --success-color: #10B981;
    --warning-color: #F59E0B;
    --error-color: #EF4444;
    --dark-bg: #1F2937;
    --darker-bg: #111827;
}
```

## 许可证

本项目采用与LLM-Manager相同的许可证。

## 贡献

欢迎提交Issue和Pull Request来改进这个现代化WebUI！